<!DOCTYPE html>

<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>foo-1</title>
	<script type="text/javascript" charset="utf-8" src="jquery-1.6.1.js"></script>
	<script type="text/javascript" charset="utf-8" src="../three.js/build/Three.js"></script>
	
	<script type="text/javascript" charset="utf-8" src="../GraphGL.js"></script>


<script id="vertexShader" type="x-shader/x-vertex" charset="utf-8">
#ifdef GL_ES
precision highp float;
#endif

void main() {
gl_Position = 	projectionMatrix *
				modelViewMatrix *
				vec4(position,1.0);
}
</script>
<script id="fragmentShader" type="x-shader/x-fragment" charset="utf-8">
#ifdef GL_ES
precision highp float;
#endif

void main() {
	gl_FragColor = vec4(0, 1.0, 1.0, 1.0);
}
</script>
<style>
		#canvas {
			background: #000;
			width: 500px;
			height: 500px;
			position:absolute;
			left:56px;
			top:30px;
		}

</style>

<script type="text/javascript" charset="utf-8">
$(document).ready(function(){
	var canvas = $("#canvas");
	
	var start = Date.now(); 
	// var data = [];
	var width = 500, height = 500;
	
	var url = "hello-world.gexf.xml";
	// var url = "file:///Users/urbanskudnik/Dev/GraphGL/examples/example-2-gexf.html";
	var layout = "force_directed.js";
	
	var gexfdata;
	var options = {
		canvas: canvas,
		width: width,
		height: height,
		layout: layout,
		layoutSend: function() {
			var worker_data = {
				options: {
					// options, by default, also includes a canvas, which prevents copying
					width: this.options.width,
					height: this.options.height
				},
				nodes: this.graph.nodes,
				edges: this.graph.edges
			};
			
			return worker_data;
		},
		layoutUpdate: function(data) {
			console.log("ggl init", data);

			// return;
			for (var nindex in data.nodes) {
				this.graph.nodes[nindex].x = data.nodes[nindex].x;
				this.graph.nodes[nindex].y = data.nodes[nindex].y; 
			}

			console.log(this.graph);
		}
	};
	
	
	var graphgl = new GraphGL(options);
	// should go to web workers....
	
	$.get(
			url, 
			function(data) {
				gexfdata = data;
				// console.log(gexfdata);
				graphgl.init(gexfdata, import_gexf);
				
				
				//.render(force_layout);
				
				
	}).error(function(e) { console.log("error - ", e); });
	
	var endall = Date.now();
	
	console.log("all: ", (endall-start)/1000);
});
</script>
</head>

<body>
<div id="canvas"></div>
</body>
</html>
